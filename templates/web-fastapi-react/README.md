# ADVL Template: web-fastapi-react
## FastAPI + React + PostgreSQL

---

## Stack

| Concern | Technology |
|---|---|
| Runtime (backend) | Python 3.12 |
| Framework (backend) | FastAPI |
| Language (backend) | Python (typed, Pydantic v2) |
| ORM | SQLAlchemy 2.0 (async) |
| Migrations | Alembic |
| Database | PostgreSQL 16 |
| Auth | FastAPI JWT (python-jose + passlib) |
| Runtime (frontend) | Node.js 22 |
| Framework (frontend) | React 18 + Vite |
| Language (frontend) | TypeScript 5 (strict) |
| Styling | Tailwind CSS 4 |
| State | TanStack Query + Zustand |
| API Client | Axios (typed) |
| Email | SMTP / Resend |
| Deployment | Docker + cloud provider |
| CI/CD | GitHub Actions |
| Testing (backend) | Pytest + httpx |
| Testing (frontend) | Vitest + Playwright |
| Package Manager (backend) | uv |
| Package Manager (frontend) | pnpm |

---

## What This Template Generates

1. **FastAPI application** with async SQLAlchemy, Pydantic v2 schemas, and typed routes
2. **JWT authentication** with access + refresh token rotation
3. **Alembic** migration tooling with initial users migration
4. **React + Vite** frontend with typed API client generated from OpenAPI schema
5. **Three environments**: `dev`, `staging`, `production` with Docker Compose configs
6. **Security baseline**: CORS, rate limiting (slowapi), input validation (Pydantic), HTTPS enforcement
7. **CI/CD pipeline**: GitHub Actions for test → lint → build → Docker image → deploy
8. **Secrets management**: `.env` templates per environment, Docker secrets support
9. **Initialized DCM.yaml** with stack declaration pre-filled

---

## Environment Variables Required

```bash
# Database
DATABASE_URL=postgresql+asyncpg://user:password@host:5432/dbname

# Auth
SECRET_KEY=
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7

# Email
SMTP_HOST=
SMTP_PORT=
SMTP_USER=
SMTP_PASSWORD=

# App
BACKEND_CORS_ORIGINS=["http://localhost:5173"]
FRONTEND_URL=
```

---

## Foundation Files (Never Modify Without Explicit ADVL Instruction)

- `app/core/security.py` — JWT creation and verification
- `app/core/config.py` — Settings model (Pydantic BaseSettings)
- `app/api/deps.py` — FastAPI dependency injection (auth, db session)
- `app/db/session.py` — Async SQLAlchemy engine and session factory
- `alembic/` — Migration environment
- `.github/workflows/` — CI/CD pipeline
- `docker-compose.yml` / `docker-compose.prod.yml` — Container definitions

---

## Getting Started (After ADVL Init)

1. Copy `.env.example` to `.env` and fill in values
2. Run `uv sync` (backend) and `pnpm install` (frontend)
3. Run `alembic upgrade head` to apply initial migration
4. Run `uvicorn app.main:app --reload` (backend) and `pnpm dev` (frontend)
5. Define your first use case and let ADVL build it

---

*ADVL Template: web-fastapi-react — Version 1.0*
*This template is generated by ADVL. Do not modify the foundation layer without explicit instruction.*
