# ADVL Template: fullstack-cloud
## Full Cloud-Native with CI/CD Included

---

## Stack

| Concern | Technology |
|---|---|
| Runtime | Node.js 22 |
| Framework (web) | Next.js 15 (App Router) |
| Framework (api) | Next.js Route Handlers or separate Fastify service |
| Language | TypeScript 5 (strict) |
| ORM | Prisma |
| Database | PostgreSQL 16 (cloud managed) |
| Auth | Supabase Auth or Auth0 (declared at init) |
| Queue | BullMQ (Redis-backed) |
| Cache | Redis (Upstash) |
| Email | Resend |
| File Storage | S3-compatible (cloud provider) |
| Styling | Tailwind CSS 4 |
| UI Components | shadcn/ui |
| State | TanStack Query + Zustand |
| Deployment | Docker + Kubernetes or cloud-native |
| CI/CD | GitHub Actions (full pipeline) |
| Testing | Vitest (unit) + Playwright (e2e) |
| Package Manager | pnpm (Turborepo monorepo) |
| Monorepo | Yes (Turborepo) |

---

## Monorepo Structure

```
/
├── apps/
│   ├── web/          ← Next.js frontend
│   └── api/          ← Separate API service (optional)
├── packages/
│   ├── db/           ← Prisma schema and client
│   ├── ui/           ← Shared component library
│   ├── config/       ← Shared TypeScript, ESLint, Tailwind configs
│   └── types/        ← Shared TypeScript types
├── infra/            ← Infrastructure as code (Terraform or Pulumi)
├── .github/
│   └── workflows/    ← CI/CD pipeline
└── turbo.json        ← Turborepo pipeline config
```

---

## What This Template Generates

1. **Turborepo monorepo** with web app, shared packages, and optional API service
2. **Auth** (Supabase Auth or Auth0) fully configured across all apps
3. **Prisma** with shared `@repo/db` package usable across the monorepo
4. **BullMQ + Redis** job queue with typed job definitions
5. **Upstash Redis** caching layer with TTL management helpers
6. **Three environments**: `dev`, `staging`, `production` with full isolation
7. **Security baseline**: WAF-ready headers, rate limiting, CSRF protection, input validation
8. **CI/CD pipeline**: Turborepo-aware GitHub Actions (only builds changed packages)
9. **Infrastructure as Code**: Terraform modules for database, Redis, storage, and DNS
10. **Docker** multi-stage builds for all services
11. **Initialized DCM.yaml** with full stack declaration

---

## Environment Variables Required

```bash
# Database
DATABASE_URL=

# Auth (Supabase)
NEXT_PUBLIC_SUPABASE_URL=
NEXT_PUBLIC_SUPABASE_ANON_KEY=
SUPABASE_SERVICE_ROLE_KEY=

# Redis / Queue
UPSTASH_REDIS_REST_URL=
UPSTASH_REDIS_REST_TOKEN=
REDIS_URL=  # For BullMQ (separate Redis instance)

# Storage
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_REGION=
S3_BUCKET_NAME=

# Email
RESEND_API_KEY=

# App
NEXT_PUBLIC_APP_URL=
API_SECRET_KEY=
```

---

## Foundation Files (Never Modify Without Explicit ADVL Instruction)

- `packages/db/` — Prisma schema, client, and migration tooling
- `apps/web/src/lib/auth/` — Auth configuration and middleware
- `apps/web/src/middleware.ts` — Edge middleware (auth, rate limiting)
- `packages/config/` — Shared ESLint, TypeScript, and Tailwind configs
- `.github/workflows/` — Full CI/CD pipeline
- `infra/` — Infrastructure as code
- `turbo.json` — Turborepo pipeline (build ordering and caching)
- `docker/` — Multi-stage Dockerfiles

---

## Getting Started (After ADVL Init)

1. Run `pnpm install` from the root
2. Copy `.env.example` to `.env.local` in each app and fill in values
3. Run `pnpm db:migrate` to apply initial migrations
4. Run `pnpm dev` to start all services via Turborepo
5. Define your first use case and let ADVL build it

---

*ADVL Template: fullstack-cloud — Version 1.0*
*This template is generated by ADVL. Do not modify the foundation layer without explicit instruction.*
