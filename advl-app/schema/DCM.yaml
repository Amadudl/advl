version: "1.0"
schema_version: "1.0"
project: "advl-app"
description: "ADVL application — visual software engineering tool"
author: "Amadeus Lederle / IEX Labs UG (haftungsbeschränkt)"
created: "2026-02-27"
last_updated: "2026-02-27"

stack:
  runtime: "Node.js 20"
  framework: "React 18 + Vite"
  language: "TypeScript 5"
  orm: null
  database: null
  auth: null
  api_style: "REST + WebSocket"
  styling: "Tailwind CSS 3"
  ui_components: null
  state_management: "Zustand"
  email: null
  file_storage: "local filesystem"
  deployment: "Electron (desktop) | Node.js server (server mode)"
  ci_cd: null
  testing: null
  package_manager: "pnpm"
  monorepo: true

adrs: []

use_cases:
  - id: "UC-001"
    title: "User opens an ADVL workspace directory"
    value: "Establishes contextual project foundation (DCM file access) to enable visual rendering and agent-assisted development architecture."
    status: "implemented"
    visual_element_id: "VE-Workspace-Open"
    actor: "ADVL User (Developer/Architect)"
    preconditions:
      - "The selected directory contains an ADVL project structure and a schema/DCM.yaml file"
    postconditions:
      - "Project DCM is parsed into memory/Zustand store"
      - "File system access is granted for relative path resolution"
    functions:
      - name: "openProjectDialog"
        file: "packages/core/src/store/workspace.store.ts"
        line: 29
        endpoint: null
        db_tables: []
        auth_required: false
        roles_required: []
        last_modified: "2026-02-27"
      - name: "openProject"
        file: "packages/core/src/store/workspace.store.ts"
        line: 46
        endpoint: null
        db_tables: []
        auth_required: false
        roles_required: []
        last_modified: "2026-02-27"
      - name: "closeProject"
        file: "packages/core/src/store/workspace.store.ts"
        line: 59
        endpoint: null
        db_tables: []
        auth_required: false
        roles_required: []
        last_modified: "2026-02-27"
      - name: "readDCM"
        file: "packages/core/src/services/dcm.service.ts"
        line: 17
        endpoint: null
        db_tables: []
        auth_required: false
        roles_required: []
        last_modified: "2026-02-27"
      - name: "loadDCM"
        file: "packages/core/src/store/dcm.store.ts"
        line: 96
        endpoint: null
        db_tables: []
        auth_required: false
        roles_required: []
        last_modified: "2026-02-27"
      - name: "dcmToDCMDocument"
        file: "packages/core/src/store/dcm.store.ts"
        line: 27
        endpoint: null
        db_tables: []
        auth_required: false
        roles_required: []
        last_modified: "2026-02-27"
      - name: "openFolderDialog"
        file: "packages/core/src/platform/adapter.browser.ts"
        line: 94
        endpoint: null
        db_tables: []
        auth_required: false
        roles_required: []
        last_modified: "2026-02-27"
      - name: "openFolderDialog"
        file: "packages/core/src/platform/adapter.electron.ts"
        line: 51
        endpoint: null
        db_tables: []
        auth_required: false
        roles_required: []
        last_modified: "2026-02-27"
    rules_applied:
      - "USE_CASE_FIRST"
      - "NO_FAKE"
      - "META_INJECTION"
    deprecated_date: null
    deprecated_reason: null
    replaced_by: null

  - id: "UC-002"
    title: "System renders DCM elements as interactive flow canvas"
    value: "Transforms static YAML architecture into a living, visual 2D diagram, enabling humans to comprehend complex data and component flows instantly."
    status: "implemented"
    visual_element_id: "VE-Canvas-Flow"
    actor: "System"
    preconditions:
      - "A valid DCM is loaded in memory"
    postconditions:
      - "React Flow canvas displays nodes for Use Cases, Functions, and Database Tables"
      - "Edges correctly map relationships (e.g., Use Case -> Function -> DB Table)"
    functions:
      - name: "buildDCMGraph"
        file: "packages/core/src/features/canvas/utils/dcm-to-flow.ts"
        line: 92
        endpoint: null
        db_tables: []
        auth_required: false
        roles_required: []
        last_modified: "2026-02-27"
      - name: "buildScreenFlowGraph"
        file: "packages/core/src/features/canvas/utils/dcm-to-flow.ts"
        line: 38
        endpoint: null
        db_tables: []
        auth_required: false
        roles_required: []
        last_modified: "2026-02-27"
      - name: "DCMArchCanvas"
        file: "packages/core/src/features/canvas/UserFlowCanvas.tsx"
        line: 131
        endpoint: null
        db_tables: []
        auth_required: false
        roles_required: []
        last_modified: "2026-02-27"
      - name: "UserFlowCanvas"
        file: "packages/core/src/features/canvas/UserFlowCanvas.tsx"
        line: 39
        endpoint: null
        db_tables: []
        auth_required: false
        roles_required: []
        last_modified: "2026-02-27"
      - name: "ScreenNode"
        file: "packages/core/src/features/canvas/nodes/ScreenNode.tsx"
        line: 19
        endpoint: null
        db_tables: []
        auth_required: false
        roles_required: []
        last_modified: "2026-02-27"
      - name: "UseCaseNode"
        file: "packages/core/src/features/canvas/nodes/UseCaseNode.tsx"
        line: 25
        endpoint: null
        db_tables: []
        auth_required: false
        roles_required: []
        last_modified: "2026-02-27"
      - name: "FunctionNode"
        file: "packages/core/src/features/canvas/nodes/FunctionNode.tsx"
        line: 18
        endpoint: null
        db_tables: []
        auth_required: false
        roles_required: []
        last_modified: "2026-02-27"
      - name: "DbTableNode"
        file: "packages/core/src/features/canvas/nodes/DbTableNode.tsx"
        line: 15
        endpoint: null
        db_tables: []
        auth_required: false
        roles_required: []
        last_modified: "2026-02-27"
      - name: "getNavigationEdges"
        file: "packages/core/src/store/dcm.store.ts"
        line: 151
        endpoint: null
        db_tables: []
        auth_required: false
        roles_required: []
        last_modified: "2026-02-27"
      - name: "getScreens"
        file: "packages/core/src/store/dcm.store.ts"
        line: 139
        endpoint: null
        db_tables: []
        auth_required: false
        roles_required: []
        last_modified: "2026-02-27"
      - name: "loadDocument"
        file: "packages/core/src/store/dcm.store.ts"
        line: 137
        endpoint: null
        db_tables: []
        auth_required: false
        roles_required: []
        last_modified: "2026-02-27"
    rules_applied:
      - "USE_CASE_FIRST"
      - "NO_FAKE"
      - "META_INJECTION"
    deprecated_date: null
    deprecated_reason: null
    replaced_by: null

  - id: "UC-003"
    title: "User queries the ADVL Agent via natural language"
    value: "Translates human intent into structured architectural intent, bridging the gap between non-technical vision and rigorous code logic execution."
    status: "implemented"
    visual_element_id: "VE-AgentChat-Submit"
    actor: "ADVL User (Developer/Architect)"
    preconditions:
      - "Workspace is open"
      - "Agent backend (LLM connection) is configured and active"
    postconditions:
      - "Agent receives query prompt"
      - "Agent evaluates query against current DCM state and project rules"
      - "Response is streamed or returned in a structured ADVL response format"
    functions:
      - name: "sendQuery"
        file: "packages/core/src/store/agent.store.ts"
        line: 120
        endpoint: null
        db_tables: []
        auth_required: false
        roles_required: []
        last_modified: "2026-02-27"
      - name: "handleAgentQuery"
        file: "packages/agent/src/agent.core.ts"
        line: 312
        endpoint: null
        db_tables: []
        auth_required: false
        roles_required: []
        last_modified: "2026-02-27"
      - name: "buildAdvlSystemPrompt"
        file: "packages/agent/src/llm.client.ts"
        line: 61
        endpoint: null
        db_tables: []
        auth_required: false
        roles_required: []
        last_modified: "2026-02-27"
      - name: "complete"
        file: "packages/agent/src/llm.client.ts"
        line: 135
        endpoint: null
        db_tables: []
        auth_required: false
        roles_required: []
        last_modified: "2026-02-27"
      - name: "parseAgentResponse"
        file: "packages/core/src/store/agent.store.ts"
        line: 56
        endpoint: null
        db_tables: []
        auth_required: false
        roles_required: []
        last_modified: "2026-02-27"
      - name: "AgentChatFeature"
        file: "packages/core/src/features/agent-chat/index.tsx"
        line: 46
        endpoint: null
        db_tables: []
        auth_required: false
        roles_required: []
        last_modified: "2026-02-27"
    rules_applied:
      - "USE_CASE_FIRST"
      - "NO_FAKE"
      - "META_INJECTION"
    deprecated_date: null
    deprecated_reason: null
    replaced_by: null

  - id: "UC-004"
    title: "User inspects detailed element metadata via canvas selection"
    value: "Provides deep traceability (code file, line numbers, assigned rulebooks) directly from the visual layer without requiring context switching."
    status: "planned"
    visual_element_id: "VE-CanvasNode-Inspector"
    actor: "ADVL User (Developer/Architect)"
    preconditions:
      - "Canvas is rendered"
      - "Node is clicked"
    postconditions:
      - "Right-hand inspector panel populates with full 'advl_meta' linked properties associated with the entity selected"
    functions: []
    rules_applied: []
    deprecated_date: null
    deprecated_reason: null
    replaced_by: null

  - id: "UC-005"
    title: "User initializes a new ADVL project from a template"
    value: "Allows developers to go from zero to a fully configured, rule-compliant architecture in minutes, eliminating the infinite foundation tax."
    status: "planned"
    visual_element_id: "VE-ProjectInit-Submit"
    actor: "ADVL User (Developer/Architect)"
    preconditions:
      - "A target directory is empty or non-existent"
      - "A baseline stack template is selected"
    postconditions:
      - "Project skeleton is generated"
      - "A clean DCM.yaml is initialized corresponding to the stack choice"
    functions: []
    rules_applied: []
    deprecated_date: null
    deprecated_reason: null
    replaced_by: null

  - id: "UC-006"
    title: "User translates a requirement into a structured Use Case via UI"
    value: "Forces the user to think in business value and structured outcomes before any code is written, ensuring USE_CASE_FIRST compliance."
    status: "planned"
    visual_element_id: "VE-UseCaseEditor-Submit"
    actor: "ADVL User (Developer/Architect)"
    preconditions:
      - "Workspace is open"
    postconditions:
      - "A new Use Case is appended to the DCM in 'planned' status"
      - "The canvas updates to reflect the new Use Case node"
    functions: []
    rules_applied: []
    deprecated_date: null
    deprecated_reason: null
    replaced_by: null

  - id: "UC-007"
    title: "System implements an approved Use Case via Agent"
    value: "Automates the translation of architecture into working code, automatically updating the DCM and preventing ghost logic."
    status: "implemented"
    visual_element_id: null
    actor: "System"
    preconditions:
      - "A 'planned' Use Case exists and is approved for generation"
    postconditions:
      - "Source code is written/modified to implement the Use Case"
      - "DCM Use Case status changes to 'implemented'"
      - "DCM functions array is updated with precise file/line tracking"
    functions:
      - name: "handleCodeGenerate"
        file: "packages/agent/src/agent.core.ts"
        line: 240
        endpoint: null
        db_tables: []
        auth_required: false
        roles_required: []
        last_modified: "2026-02-27"
      - name: "handleUseCaseSubmit"
        file: "packages/agent/src/agent.core.ts"
        line: 42
        endpoint: null
        db_tables: []
        auth_required: false
        roles_required: []
        last_modified: "2026-02-27"
      - name: "registerUseCase"
        file: "packages/agent/src/dcm.engine.ts"
        line: 50
        endpoint: null
        db_tables: []
        auth_required: false
        roles_required: []
        last_modified: "2026-02-27"
      - name: "queryFunctions"
        file: "packages/agent/src/dcm.engine.ts"
        line: 79
        endpoint: null
        db_tables: []
        auth_required: false
        roles_required: []
        last_modified: "2026-02-27"
      - name: "queryUseCases"
        file: "packages/agent/src/dcm.engine.ts"
        line: 125
        endpoint: null
        db_tables: []
        auth_required: false
        roles_required: []
        last_modified: "2026-02-27"
      - name: "stream"
        file: "packages/agent/src/llm.client.ts"
        line: 183
        endpoint: null
        db_tables: []
        auth_required: false
        roles_required: []
        last_modified: "2026-02-27"
      - name: "parseAgentResponse"
        file: "packages/core/src/store/agent.store.ts"
        line: 56
        endpoint: null
        db_tables: []
        auth_required: false
        roles_required: []
        last_modified: "2026-02-27"
    rules_applied:
      - "USE_CASE_FIRST"
      - "NO_FAKE"
      - "META_INJECTION"
    deprecated_date: null
    deprecated_reason: null
    replaced_by: null

  - id: "UC-008"
    title: "System validates project compliance against ADVL Rulebooks"
    value: "Prevents technical debt and drift by continuously verifying NO_FAKE, NO_DUPLICATE, and META_INJECTION compliance before any commits."
    status: "planned"
    visual_element_id: "VE-Compliance-Runner"
    actor: "System"
    preconditions:
      - "Workspace is open"
    postconditions:
      - "DCM and codebase are scanned"
      - "Violations (ghost logic, missing meta, empty stubs) are surfaced in the UI"
    functions: []
    rules_applied: []
    deprecated_date: null
    deprecated_reason: null
    replaced_by: null

  - id: "UC-009"
    title: "User injects advl_meta into a visual component via Canvas/IDE"
    value: "Creates the unbreakable, machine-readable bond between the visual UI surface and the backend logic, guaranteeing accurate traceability."
    status: "planned"
    visual_element_id: "VE-MetaInjector-Bind"
    actor: "ADVL User (Developer/Architect)"
    preconditions:
      - "A valid React/UI component exists"
      - "A target function is registered in the DCM"
    postconditions:
      - "The component source file is updated with the advl_meta JSON block"
    functions: []
    rules_applied: []
    deprecated_date: null
    deprecated_reason: null
    replaced_by: null

deprecated: []

snapshots: []